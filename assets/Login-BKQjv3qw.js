import{_,c as d,o as u,d as s,w as k,b as m,i as w,m as y,n as v,t as h,s as P,h as O,x as B,u as C,y as a,z as x}from"./index-F71AAdkV.js";import{_ as L}from"./logo-main-MG4Gk-K-.js";const S={name:"Login",setup(){const p=B(),o=C(),l=a(""),e=a(""),f=a(!1),c=a(!1),r=a(""),g=a({username:"",password:""});x(()=>{if(localStorage.getItem("user"))try{p.push({path:"/"})}catch(t){console.error("Navigation error:",t),window.location.href="/"}});const b=()=>{let n=!0;return g.value={username:"",password:""},l.value||(g.value.username="Vui lòng nhập tên đăng nhập",n=!1),e.value||(g.value.password="Vui lòng nhập mật khẩu",n=!1),n};return{username:l,password:e,showPassword:f,loading:c,error:r,errors:g,handleLogin:async n=>{if(n.preventDefault(),!!b()){c.value=!0,r.value="";try{if(l.value==="admin"&&e.value==="123456"){await new Promise(i=>setTimeout(i,1e3));const t={username:l.value,role:"admin",token:"mock-token-"+Date.now(),expiresAt:new Date(Date.now()+30*24*60*60*1e3).toISOString()};localStorage.setItem("user",JSON.stringify(t)),window.dispatchEvent(new CustomEvent("user-logged-in",{detail:t})),o.success("Đăng nhập thành công!",{timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1}),setTimeout(()=>{try{const i=localStorage.getItem("previousPath")||"/";p.replace(i),localStorage.removeItem("previousPath")}catch(i){console.error("Navigation error:",i),window.location.href="/"}},1e3)}else r.value="Tên đăng nhập hoặc mật khẩu không đúng",o.error("Tên đăng nhập hoặc mật khẩu không đúng",{timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1})}catch(t){r.value="Có lỗi xảy ra, vui lòng thử lại",o.error("Có lỗi xảy ra, vui lòng thử lại",{timeout:3e3,closeOnClick:!0,pauseOnFocusLoss:!0,pauseOnHover:!0,draggable:!0,draggablePercent:.6,showCloseButtonOnHover:!1,hideProgressBar:!1,closeButton:"button",icon:!0,rtl:!1}),console.error("Login error:",t)}finally{c.value=!1}}}}}},D={class:"login-page"},N={class:"login-container"},T={class:"form-group"},V={key:0,class:"invalid-feedback"},H={class:"form-group"},I={class:"password-input"},M=["type"],F={key:0,class:"invalid-feedback"},E={class:"form-group"},z=["disabled"],U={key:0,class:"spinner-border spinner-border-sm me-2"},A={key:0,class:"alert alert-danger",role:"alert"};function J(p,o,l,e,f,c){return u(),d("div",D,[s("div",N,[o[6]||(o[6]=s("div",{class:"login-header"},[s("img",{src:L,alt:"Logo",class:"login-logo"}),s("h2",null,"Đăng nhập")],-1)),s("form",{onSubmit:o[3]||(o[3]=k((...r)=>e.handleLogin&&e.handleLogin(...r),["prevent"])),class:"login-form"},[s("div",T,[o[4]||(o[4]=s("label",{for:"username"},"Tên đăng nhập",-1)),w(s("input",{type:"text",id:"username","onUpdate:modelValue":o[0]||(o[0]=r=>e.username=r),class:v(["form-control",{"is-invalid":e.errors.username}]),placeholder:"Nhập tên đăng nhập"},null,2),[[y,e.username]]),e.errors.username?(u(),d("div",V,h(e.errors.username),1)):m("",!0)]),s("div",H,[o[5]||(o[5]=s("label",{for:"password"},"Mật khẩu",-1)),s("div",I,[w(s("input",{type:e.showPassword?"text":"password",id:"password","onUpdate:modelValue":o[1]||(o[1]=r=>e.password=r),class:v(["form-control",{"is-invalid":e.errors.password}]),placeholder:"Nhập mật khẩu"},null,10,M),[[P,e.password]]),s("button",{type:"button",class:"toggle-password",onClick:o[2]||(o[2]=r=>e.showPassword=!e.showPassword)},[s("i",{class:v(e.showPassword?"fi fi-br-eye-crossed":"fi fi-br-eye")},null,2)])]),e.errors.password?(u(),d("div",F,h(e.errors.password),1)):m("",!0)]),s("div",E,[s("button",{type:"submit",class:"btn-login",disabled:e.loading},[e.loading?(u(),d("span",U)):m("",!0),O(" "+h(e.loading?"Đang đăng nhập...":"Đăng nhập"),1)],8,z)]),e.error?(u(),d("div",A,h(e.error),1)):m("",!0)],32)])])}const G=_(S,[["render",J],["__scopeId","data-v-a5d72642"]]);export{G as default};
